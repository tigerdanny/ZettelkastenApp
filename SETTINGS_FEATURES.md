# Zettelkasten 設置功能實作

## 功能概述

本次更新實作了完整的設置頁面功能，包括：

### 1. 常規設置
- ✅ **深色模式**: 支持亮色/深色主題切換
  - 自動應用到整個應用
  - 保存用戶偏好設置
  - 即時生效

### 2. 安全設置
- ✅ **密碼保護**: 
  - 設置應用密碼
  - 密碼加密存儲（SHA-256 + 鹽值）
  - 應用啟動時需要密碼驗證
  - 支持修改和移除密碼

- ✅ **生物識別**: 
  - 指紋/面部識別支持
  - 僅在設置密碼後可用
  - 自動檢測設備支持情況
  - 快速解鎖功能

### 3. 數據管理
- ✅ **清除所有數據**: 
  - 刪除所有卡片、標籤和連結
  - 確認對話框防止誤操作
  - 不可恢復的操作警告

### 4. 關於信息
- ✅ **版本信息**: 
  - 顯示應用版本號
  - 顯示構建版本
  - 開發者信息

## 技術實作

### 核心類別

1. **AppPreferenceManager**: 
   - 統一管理應用偏好設置
   - 單例模式確保數據一致性
   - 支持深色模式、密碼、生物識別設置

2. **PasswordUtils**: 
   - 安全的密碼加密/驗證
   - 使用SHA-256哈希算法
   - 隨機鹽值增強安全性

3. **PasswordLockActivity**: 
   - 密碼驗證界面
   - 生物識別集成
   - 錯誤處理和用戶反饋

4. **BaseActivity**: 
   - 統一的主題管理
   - 自動密碼鎖定檢查
   - 應用生命週期管理

### 安全特性

- **密碼加密**: 使用SHA-256 + 隨機鹽值
- **應用鎖定**: 後台切換時自動鎖定
- **生物識別**: 支持指紋和面部識別
- **防暴力破解**: 錯誤提示和延遲

### 用戶體驗

- **即時主題切換**: 深色模式立即生效
- **智能解鎖**: 優先使用生物識別
- **清晰反饋**: 操作結果即時提示
- **安全確認**: 重要操作需要確認

## 使用說明

### 設置密碼
1. 進入設置頁面
2. 點擊"設置密碼"
3. 輸入密碼（至少4個字符）
4. 確認密碼
5. 密碼設置成功

### 啟用生物識別
1. 首先設置應用密碼
2. 在設置中開啟"生物識別"
3. 下次啟動時可使用生物識別解鎖

### 深色模式
1. 在設置中切換"深色模式"開關
2. 主題立即生效
3. 設置會自動保存

### 清除數據
1. 點擊"清除所有數據"
2. 確認操作（不可恢復）
3. 應用重新啟動

## 文件結構

```
app/src/main/
├── java/com/example/zettelkasten/
│   ├── ui/
│   │   ├── PasswordLockActivity.kt     # 密碼鎖定頁面
│   │   ├── SettingsFragment.kt         # 設置頁面
│   │   └── BaseActivity.kt             # 基礎Activity
│   └── utils/
│       ├── AppPreferenceManager.kt     # 偏好設置管理
│       └── PasswordUtils.kt            # 密碼工具類
├── res/
│   ├── layout/
│   │   ├── activity_password_lock.xml  # 密碼鎖定佈局
│   │   └── dialog_set_password.xml     # 密碼設置對話框
│   ├── values/
│   │   └── colors.xml                  # 亮色主題顏色
│   ├── values-night/
│   │   └── colors.xml                  # 深色主題顏色
│   ├── xml/
│   │   └── preferences.xml             # 設置頁面配置
│   └── drawable/
│       ├── ic_dark_mode.xml            # 深色模式圖標
│       ├── ic_lock.xml                 # 鎖定圖標
│       ├── ic_fingerprint.xml          # 指紋圖標
│       └── ic_delete_forever.xml       # 刪除圖標
└── AndroidManifest.xml                 # 添加PasswordLockActivity
```

## 注意事項

1. **密碼安全**: 密碼使用加密存儲，但請設置強密碼
2. **生物識別**: 需要設備硬件支持
3. **數據清除**: 操作不可恢復，請謹慎使用
4. **主題切換**: 深色模式會立即應用到整個應用

## 測試建議

1. 測試密碼設置和驗證
2. 測試生物識別功能（如果設備支持）
3. 測試深色模式切換
4. 測試應用鎖定/解鎖流程
5. 測試數據清除功能 
